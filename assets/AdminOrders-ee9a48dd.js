import{P as A,M as x}from"./PaginationComponent-a3600ccc.js";import{g as P}from"./getDate-a6a896d2.js";import{_ as C,d as n,e,F as u,l as p,f as T,n as w,t as o,h as M,c as D,o as a}from"./index-041fce4e.js";const{VITE_APP_URL:h,VITE_APP_PATH:m}={BASE_URL:"/998rrr/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};let b,_;const E={components:{PaginationComponent:A},data(){return{orders:[],tempOrder:{},pages:{},delAll:!1}},mixins:[P],methods:{getOrders(l=1){const d=`${h}/api/${m}/admin/orders?page=${l}`,f=document.cookie.replace(/(?:(?:^|.*;\s*)drmemeToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=f,this.$http.get(d).then(i=>{this.orders=i.data.orders,this.pages=i.data.pagination}).catch(i=>{console.error(i)})},openModal(l,d){l==="view"?(b.show(),this.tempOrder={...d}):l==="delete"?(this.delAll=!1,_.show(),this.tempOrder={...d}):l==="deleteAll"&&(this.delAll=!0,_.show())},viewOrder(l){const d=`${h}/api/${m}/admin/order/${l}`;this.$http.put(d,{data:this.tempOrder}).then(()=>{this.getOrders(),b.hide()})},deleteOrder(){const l=`${h}/api/${m}/admin/order/${this.tempOrder.id}`;this.$http.delete(l).then(()=>{this.getOrders(),_.hide()})},deleteAllOrders(){const l=`${h}/api/${m}/admin/orders/all`;this.$http.delete(l).then(()=>{this.getOrders(),_.hide()})}},mounted(){this.getOrders(),b=new x(this.$refs.orderModal),_=new x(this.$refs.delOrderModal)}},$={class:"py-3"},N={class:"d-flex justify-content-between"},L=e("h1",{class:"fs-4 fw-bold"},"訂單管理",-1),V={class:"table table-hover mt-4 align-middle"},B=e("thead",null,[e("tr",null,[e("th",null,"訂單日期"),e("th",null,"訂購人資訊"),e("th",null,"訂購商品"),e("th",null,"金額"),e("th",{width:"120"},"付款狀態"),e("th",{width:"120"},"編輯")])],-1),R=["onClick"],S=e("i",{class:"fa-solid fa-eye"},null,-1),U=[S],j=["onClick"],q=e("i",{class:"fa-solid fa-trash-can"},null,-1),z=[q],F={class:"d-flex justify-content-center"},I={class:"modal fade",ref:"orderModal",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true","data-bs-backdrop":"static"},H={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-xl-down"},G={class:"modal-content"},J=e("div",{class:"modal-header bg-orange-998-500"},[e("h1",{class:"modal-title fs-5 fw-bold text-light",id:"orderModalLabel"}," 查看訂單 "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),K={class:"modal-body"},Q={class:"row"},W={class:"col-sm-5"},X={class:"border border-secondary-600 p-4 rounded-3"},Y=e("h2",{class:"fs-5 fw-bold"},"訂單資料",-1),Z={class:"mt-3"},ee=e("label",{for:"inputOrderNumber",class:"form-label mb-1"},"訂單編號",-1),te=["value"],se={class:"mt-3"},le=e("label",{for:"inputOrderDate",class:"form-label mb-1"},"訂單日期",-1),oe=["value"],de={class:"mt-3"},ne=e("label",{for:"inputOrderPaid",class:"form-label mb-1"},"訂單付款狀態",-1),ae=["value"],re={class:"border border-secondary-600 p-4 mt-6 rounded-3"},ie=e("h2",{class:"fs-5 fw-bold"},"訂購人資訊",-1),ce={class:"mt-3"},_e=e("label",{for:"inputOrderPerson",class:"form-label mb-1"},"訂購人姓名",-1),ue=["value"],he={class:"mt-3"},me=e("label",{for:"inputOrderTel",class:"form-label mb-1"},"訂購人手機",-1),pe=["value"],be={class:"mt-3"},fe=e("label",{for:"inputOrderEmail",class:"form-label mb-1"},"訂購人Email",-1),ve=["value"],Oe={class:"mt-3"},ye=e("label",{for:"inputOrderAddress",class:"form-label mb-1"},"收件地址",-1),ge=["value"],xe={class:"mt-3"},we=e("label",{for:"inputOrderMsg",class:"form-label mb-1"},"訂單備註",-1),Me=["value"],ke={class:"col-sm-7"},Ae={class:"border border-secondary-600 p-4 rounded-3"},Pe=e("h2",{class:"fs-5 fw-bold"},"訂購商品",-1),Ce={class:"table align-middle"},Te=e("thead",null,[e("tr",null,[e("td",null,"縮圖"),e("td",null,"品項"),e("td",{width:"90"},"數量"),e("td",{class:"text-end"},"小計")])],-1),De=["src","alt"],Ee={class:"mb-0"},$e={class:"text-end"},Ne=e("td",{colspan:"3",class:"fs-3"},"總金額",-1),Le={class:"text-end fs-3"},Ve={class:"modal fade",ref:"delOrderModal",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},Be={class:"modal-dialog"},Re={class:"modal-content border-0"},Se={class:"modal-header bg-danger text-white"},Ue={id:"delOrderModalLabel",class:"modal-title"},je=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),qe={class:"modal-body"},ze={key:0},Fe={class:"text-danger"},Ie={key:1},He=e("p",{class:"fw-bold mt-4"},"** 刪除後將無法恢復 **",-1),Ge={class:"modal-footer"},Je=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ke(l,d,f,i,s,r){var v,O,y,g;const k=D("PaginationComponent");return a(),n(u,null,[e("div",$,[e("div",N,[L,e("button",{type:"button",class:"btn btn-outline-secondary-700 fw-bold",onClick:d[0]||(d[0]=t=>r.openModal("deleteAll",l.order))}," 刪除所有訂單 ")]),e("table",V,[B,e("tbody",null,[(a(!0),n(u,null,p(s.orders,t=>(a(),n("tr",{key:t.id},[e("td",null,o(l.getDate(t.create_at)),1),e("td",null,[e("ul",null,[e("li",null,o(t.user.name),1),e("li",null,o(t.user.email),1),e("li",null,o(t.user.tel),1)])]),e("td",null,[(a(!0),n(u,null,p(t.products,c=>(a(),n("ul",{key:c.product_id},[e("li",null,o(c.product.title)+" x "+o(c.qty),1)]))),128))]),e("td",null,"NT$ "+o(t.total),1),e("td",{class:w(["fw-bold",t.is_paid?"text-success":"text-danger"])},o(t.is_paid?"已付款":"未付款"),3),e("td",null,[e("button",{type:"button",class:"btn text-dark fw-bold",onClick:c=>r.openModal("view",t)},U,8,R),e("button",{type:"button",class:"btn text-dark fw-bold",onClick:c=>r.openModal("delete",t)},z,8,j)])]))),128))])]),e("div",F,[T(k,{pages:s.pages,"get-items":r.getOrders},null,8,["pages","get-items"])])]),e("div",I,[e("div",H,[e("div",G,[J,e("div",K,[e("div",Q,[e("div",W,[e("div",X,[Y,e("div",Z,[ee,e("input",{type:"text",class:"form-control",id:"inputOrderNumber",value:s.tempOrder.id,readonly:""},null,8,te)]),e("div",se,[le,e("input",{type:"text",class:"form-control",id:"inputOrderDate",value:l.getDate(s.tempOrder.create_at),readonly:""},null,8,oe)]),e("div",de,[ne,e("input",{type:"text",class:w(["form-control",s.tempOrder.is_paid?"text-success":"text-danger"]),id:"inputOrderPaid",value:s.tempOrder.is_paid?"已付款":"未付款",readonly:""},null,10,ae)])]),e("div",re,[ie,e("div",ce,[_e,e("input",{type:"text",class:"form-control",id:"inputOrderPerson",value:(v=s.tempOrder.user)==null?void 0:v.name,readonly:""},null,8,ue)]),e("div",he,[me,e("input",{type:"text",class:"form-control",id:"inputOrderTel",value:(O=s.tempOrder.user)==null?void 0:O.tel,readonly:""},null,8,pe)]),e("div",be,[fe,e("input",{type:"text",class:"form-control",id:"inputOrderEmail",value:(y=s.tempOrder.user)==null?void 0:y.email,readonly:""},null,8,ve)]),e("div",Oe,[ye,e("input",{type:"text",class:"form-control",id:"inputOrderAddress",value:(g=s.tempOrder.user)==null?void 0:g.address,readonly:""},null,8,ge)]),e("div",xe,[we,e("input",{type:"text",class:"form-control",id:"inputOrderMsg",value:s.tempOrder.message,readonly:""},null,8,Me)])])]),e("div",ke,[e("div",Ae,[Pe,e("table",Ce,[Te,e("tbody",null,[(a(!0),n(u,null,p(s.tempOrder.products,t=>(a(),n("tr",{key:t.id},[e("td",null,[e("img",{src:t.product.imageUrl,alt:t.product.title,class:"thumbnail"},null,8,De)]),e("td",null,[e("p",Ee,o(t.product.title),1)]),e("td",null,o(t.qty),1),e("td",$e," NT$"+o(Math.round(t.final_total)),1)]))),128)),e("tr",null,[Ne,e("td",Le,"NT$ "+o(s.tempOrder.total),1)])])])])])])])])])],512),e("div",Ve,[e("div",Be,[e("div",Re,[e("div",Se,[e("h5",Ue,[e("span",null,"刪除"+o(s.delAll?"所有":"該筆")+"訂單",1)]),je]),e("div",qe,[s.delAll?(a(),n("p",Ie,"是否刪除所有訂單")):(a(),n("p",ze,[M(" 是否刪除編號 "),e("strong",Fe,o(s.tempOrder.id)+" 訂單",1),M("? ")])),He]),e("div",Ge,[e("button",{type:"button",class:"btn btn-danger",onClick:d[1]||(d[1]=t=>s.delAll?r.deleteAllOrders():r.deleteOrder())}," 確認刪除"),Je])])])],512)],64)}const Ye=C(E,[["render",Ke]]);export{Ye as default};
