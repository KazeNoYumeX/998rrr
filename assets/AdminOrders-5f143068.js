import{P as A,M as x}from"./PaginationComponent-08a90b14.js";import{g as P}from"./getDate-a6a896d2.js";import{_ as C,d as n,e as t,F as p,k as f,f as T,n as w,t as o,h as k,c as D,o as r}from"./index-7f424c35.js";const{VITE_APP_URL:b,VITE_APP_PATH:c}={BASE_URL:"/998rrr/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};let _,m;const E={components:{PaginationComponent:A},data(){return{orders:[],tempOrder:{},pages:{},delAll:!1}},mixins:[P],methods:{getOrders(d=1){const e=`${b}/api/${c}/admin/orders?page=${d}`,h=document.cookie.replace(/(?:(?:^|.*;\s*)drmemeToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=h,this.$http.get(e).then(a=>{this.orders=a.data.orders,this.pages=a.data.pagination}).catch(a=>{console.error(a)})},openModal(d,e){d==="view"?(_.show(),this.tempOrder={...e}):d==="delete"?(this.delAll=!1,m.show(),this.tempOrder={...e}):d==="deleteAll"&&(this.delAll=!0,m.show())},viewOrder(d){const e=`${b}/api/${c}/admin/order/${d}`;this.$http.put(e,{data:this.tempOrder}).then(()=>{this.getOrders(),_.hide()})},deleteOrder(){const d=`${b}/api/${c}/admin/order/${this.tempOrder.id}`;this.$http.delete(d).then(()=>{this.getOrders(),m.hide()})},deleteAllOrders(){const d=`${b}/api/${c}/admin/orders/all`;this.$http.delete(d).then(()=>{this.getOrders(),m.hide()})}},mounted(){this.getOrders(),_=new x(this.$refs.orderModal),m=new x(this.$refs.delOrderModal)}},$={class:"py-3"},N={class:"d-flex justify-content-between"},L={class:"table table-hover mt-4 align-middle"},V=["onClick"],B=["onClick"],R={class:"d-flex justify-content-center"},S={class:"modal fade",ref:"orderModal",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true","data-bs-backdrop":"static"},U={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-xl-down"},j={class:"modal-content"},q={class:"modal-body"},z={class:"row"},F={class:"col-sm-5"},I={class:"border border-secondary-600 p-4 rounded-3"},H={class:"mt-3"},G=["value"],J={class:"mt-3"},K=["value"],Q={class:"mt-3"},W=["value"],X={class:"border border-secondary-600 p-4 mt-6 rounded-3"},Y={class:"mt-3"},Z=["value"],tt={class:"mt-3"},et=["value"],lt={class:"mt-3"},st=["value"],dt={class:"mt-3"},ot=["value"],nt={class:"mt-3"},rt=["value"],it={class:"col-sm-7"},at={class:"border border-secondary-600 p-4 rounded-3"},ut={class:"table align-middle"},mt=["src","alt"],pt={class:"mb-0"},bt={class:"text-end"},ct={class:"text-end fs-3"},ft={class:"modal fade",ref:"delOrderModal",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},_t={class:"modal-dialog"},ht={class:"modal-content border-0"},vt={class:"modal-header bg-danger text-white"},Ot={id:"delOrderModalLabel",class:"modal-title"},yt={class:"modal-body"},gt={key:0},xt={class:"text-danger"},wt={key:1},kt={class:"modal-footer"};function Mt(d,e,h,a,s,i){var v,O,y,g;const M=D("PaginationComponent");return r(),n(p,null,[t("div",$,[t("div",N,[e[2]||(e[2]=t("h1",{class:"fs-4 fw-bold"},"訂單管理",-1)),t("button",{type:"button",class:"btn btn-outline-secondary-700 fw-bold",onClick:e[0]||(e[0]=l=>i.openModal("deleteAll",d.order))}," 刪除所有訂單 ")]),t("table",L,[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",null,"訂單日期"),t("th",null,"訂購人資訊"),t("th",null,"訂購商品"),t("th",null,"金額"),t("th",{width:"120"},"付款狀態"),t("th",{width:"120"},"編輯")])],-1)),t("tbody",null,[(r(!0),n(p,null,f(s.orders,l=>(r(),n("tr",{key:l.id},[t("td",null,o(d.getDate(l.create_at)),1),t("td",null,[t("ul",null,[t("li",null,o(l.user.name),1),t("li",null,o(l.user.email),1),t("li",null,o(l.user.tel),1)])]),t("td",null,[(r(!0),n(p,null,f(l.products,u=>(r(),n("ul",{key:u.product_id},[t("li",null,o(u.product.title)+" x "+o(u.qty),1)]))),128))]),t("td",null,"NT$ "+o(l.total),1),t("td",{class:w(["fw-bold",l.is_paid?"text-success":"text-danger"])},o(l.is_paid?"已付款":"未付款"),3),t("td",null,[t("button",{type:"button",class:"btn text-dark fw-bold",onClick:u=>i.openModal("view",l)},e[3]||(e[3]=[t("i",{class:"fa-solid fa-eye"},null,-1)]),8,V),t("button",{type:"button",class:"btn text-dark fw-bold",onClick:u=>i.openModal("delete",l)},e[4]||(e[4]=[t("i",{class:"fa-solid fa-trash-can"},null,-1)]),8,B)])]))),128))])]),t("div",R,[T(M,{pages:s.pages,"get-items":i.getOrders},null,8,["pages","get-items"])])]),t("div",S,[t("div",U,[t("div",j,[e[19]||(e[19]=t("div",{class:"modal-header bg-orange-998-500"},[t("h1",{class:"modal-title fs-5 fw-bold text-light",id:"orderModalLabel"},"查看訂單"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",q,[t("div",z,[t("div",F,[t("div",I,[e[9]||(e[9]=t("h2",{class:"fs-5 fw-bold"},"訂單資料",-1)),t("div",H,[e[6]||(e[6]=t("label",{for:"inputOrderNumber",class:"form-label mb-1"},"訂單編號",-1)),t("input",{type:"text",class:"form-control",id:"inputOrderNumber",value:s.tempOrder.id,readonly:""},null,8,G)]),t("div",J,[e[7]||(e[7]=t("label",{for:"inputOrderDate",class:"form-label mb-1"},"訂單日期",-1)),t("input",{type:"text",class:"form-control",id:"inputOrderDate",value:d.getDate(s.tempOrder.create_at),readonly:""},null,8,K)]),t("div",Q,[e[8]||(e[8]=t("label",{for:"inputOrderPaid",class:"form-label mb-1"},"訂單付款狀態",-1)),t("input",{type:"text",class:w(["form-control",s.tempOrder.is_paid?"text-success":"text-danger"]),id:"inputOrderPaid",value:s.tempOrder.is_paid?"已付款":"未付款",readonly:""},null,10,W)])]),t("div",X,[e[15]||(e[15]=t("h2",{class:"fs-5 fw-bold"},"訂購人資訊",-1)),t("div",Y,[e[10]||(e[10]=t("label",{for:"inputOrderPerson",class:"form-label mb-1"},"訂購人姓名",-1)),t("input",{type:"text",class:"form-control",id:"inputOrderPerson",value:(v=s.tempOrder.user)==null?void 0:v.name,readonly:""},null,8,Z)]),t("div",tt,[e[11]||(e[11]=t("label",{for:"inputOrderTel",class:"form-label mb-1"},"訂購人手機",-1)),t("input",{type:"text",class:"form-control",id:"inputOrderTel",value:(O=s.tempOrder.user)==null?void 0:O.tel,readonly:""},null,8,et)]),t("div",lt,[e[12]||(e[12]=t("label",{for:"inputOrderEmail",class:"form-label mb-1"},"訂購人Email",-1)),t("input",{type:"text",class:"form-control",id:"inputOrderEmail",value:(y=s.tempOrder.user)==null?void 0:y.email,readonly:""},null,8,st)]),t("div",dt,[e[13]||(e[13]=t("label",{for:"inputOrderAddress",class:"form-label mb-1"},"收件地址",-1)),t("input",{type:"text",class:"form-control",id:"inputOrderAddress",value:(g=s.tempOrder.user)==null?void 0:g.address,readonly:""},null,8,ot)]),t("div",nt,[e[14]||(e[14]=t("label",{for:"inputOrderMsg",class:"form-label mb-1"},"訂單備註",-1)),t("input",{type:"text",class:"form-control",id:"inputOrderMsg",value:s.tempOrder.message,readonly:""},null,8,rt)])])]),t("div",it,[t("div",at,[e[18]||(e[18]=t("h2",{class:"fs-5 fw-bold"},"訂購商品",-1)),t("table",ut,[e[17]||(e[17]=t("thead",null,[t("tr",null,[t("td",null,"縮圖"),t("td",null,"品項"),t("td",{width:"90"},"數量"),t("td",{class:"text-end"},"小計")])],-1)),t("tbody",null,[(r(!0),n(p,null,f(s.tempOrder.products,l=>(r(),n("tr",{key:l.id},[t("td",null,[t("img",{src:l.product.imageUrl,alt:l.product.title,class:"thumbnail"},null,8,mt)]),t("td",null,[t("p",pt,o(l.product.title),1)]),t("td",null,o(l.qty),1),t("td",bt,"NT$"+o(Math.round(l.final_total)),1)]))),128)),t("tr",null,[e[16]||(e[16]=t("td",{colspan:"3",class:"fs-3"},"總金額",-1)),t("td",ct,"NT$ "+o(s.tempOrder.total),1)])])])])])])])])])],512),t("div",ft,[t("div",_t,[t("div",ht,[t("div",vt,[t("h5",Ot,[t("span",null,"刪除"+o(s.delAll?"所有":"該筆")+"訂單",1)]),e[20]||(e[20]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",yt,[s.delAll?(r(),n("p",wt,"是否刪除所有訂單")):(r(),n("p",gt,[e[21]||(e[21]=k(" 是否刪除編號 ")),t("strong",xt,o(s.tempOrder.id)+" 訂單",1),e[22]||(e[22]=k("? "))])),e[23]||(e[23]=t("p",{class:"fw-bold mt-4"},"** 刪除後將無法恢復 **",-1))]),t("div",kt,[t("button",{type:"button",class:"btn btn-danger",onClick:e[1]||(e[1]=l=>s.delAll?i.deleteAllOrders():i.deleteOrder())}," 確認刪除"),e[24]||(e[24]=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1))])])])],512)],64)}const Tt=C(E,[["render",Mt]]);export{Tt as default};
